# Generated by confd {{datetime}}
# Doc: https://github.com/kelseyhightower/confd/blob/master/docs/templates.md

listen       {{getv "/nginx/listen/port"}} default_server;
server_name  _;
root         /usr/share/nginx/html;

location / {

{{if exists "/nginx/proxy/target"}}
  proxy_pass            {{getv "/nginx/proxy/target"}};

  proxy_set_header      Host                              $http_host;
  proxy_set_header      X-Real-IP                         $remote_addr;
  proxy_set_header      X-Forwarded-For                   $proxy_add_x_forwarded_for;
  proxy_set_header      X-Forwarded-Proto                 $scheme;

  {{range getvs "/nginx/proxy/header/*"}}
  proxy_set_header      {{.}};
  {{end}}

  {{if exists "/nginx/proxy/timeout/read"}}
  proxy_read_timeout    {{getv "/nginx/proxy/timeout/read"}};
  {{end}}
{{end}}

{{range getvs "/nginx/header/*"}}
  add_header      {{.}};
{{end}}

{{range getvs "/nginx/rewrite/permanent/*"}}
  rewrite         {{.}}     permanent;
{{end}}
{{range getvs "/nginx/rewrite/temporary/*"}}
  rewrite         {{.}}     redirect;
{{end}}

}

error_page 404 /404.html;
  location = /40x.html {
}

error_page 500 502 503 504 /50x.html;
  location = /50x.html {
}
